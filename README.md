# GRANGER
Granger recurrent autoencoders to network gene expression regulations

## Requirements
GRANGER requires you to create a PyTorch environment and install the following packages

python                    3.11.5 

pytorch                   2.1.0

pandas                    2.1.4

scanpy                    1.10.1

scikit-learn              1.2.2

numpy                     1.26.0 


## Scripts
### The code of GRANGER mainly includes the following scripts:

**timepseudo.py**: this script is used to process data with time-series information, which can reorder cells  according to the information in refNetwork.csv and generate a new input file. For data without time  information, you can use to_npy to directly generate an input file.

**proprocess.py**: define some functions that you can use to obtain tf_list (list of transcription factors) and gene expression matrix, and format label files and calculate AUROC and AUPR.

**GRANGER_demo.py**:run the model and defines some parameters that you can adjust to achieve better results.

**granger_model.py**: The main code of the model, which contains the framework of the model. It will generate a matrix reflecting the strength of regulatory relationships between genes and save it as a CSV file. You can use it for subsequent analysis.

**generate_res.py**: Further process the intensity score matrix generated by the model to obtain a standard format (gene_A gene_B correlation_score) for analysis.
